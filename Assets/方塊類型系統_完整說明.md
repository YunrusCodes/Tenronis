# æ–¹å¡Šé¡å‹ç³»çµ± - å®Œæ•´å¯¦ç¾èªªæ˜

## ğŸ® ç³»çµ±æ¦‚è¿°

éŠæˆ²ä¸­çš„æ–¹å¡Šç¾åœ¨æ“æœ‰ä¸‰ç¨®ç‰¹æ€§é¡å‹ï¼š

### 1. Normalï¼ˆæ™®é€šæ–¹å¡Šï¼‰âœ…
- **ä¾†æº**ï¼šç©å®¶æ”¾ç½®çš„æ–¹å¡Šã€é—œå¡ 1-7 æ•µäººç”Ÿæˆçš„æ–¹å¡Š
- **æ¶ˆé™¤æ•ˆæœ**ï¼šæ­£å¸¸ç”¢ç”Ÿå°å½ˆ
- **è¢«å°„æ“Šæ•ˆæœ**ï¼šæ­£å¸¸å‚·å®³ï¼ŒHP æ¸›å°‘
- **ç‰¹æ€§**ï¼šç„¡ç‰¹æ®Šæ•ˆæœ

### 2. Voidï¼ˆè™›ç„¡æ–¹å¡Šï¼‰ğŸŒ€
- **ä¾†æº**ï¼šçµ‚ç„‰æ©Ÿæ¢°ç¥ï¼ˆé—œå¡ 10ï¼‰æ’å…¥çš„åƒåœ¾è¡Œ
- **æ¶ˆé™¤æ•ˆæœ**ï¼š
  - âŒ **ä¸ç”¢ç”Ÿå°å½ˆ**ï¼ˆé€™æ˜¯æ ¸å¿ƒç‰¹æ€§ï¼‰
  - é¡¯ç¤º"è™›ç„¡æŠµéŠ·!"è€Œé"é½Šå°„ xN"
  - å³ä½¿åªæ¶ˆé™¤ 1 æ’ä¹Ÿæœƒé¡¯ç¤ºæç¤º
- **è¢«å°„æ“Šæ•ˆæœ**ï¼šä¸å¯æ‘§æ¯€ï¼ˆisIndestructible = trueï¼‰
- **ç‰¹æ€§**ï¼šå¸æ”¶ç©å®¶çš„æ”»æ“Šï¼Œéœ€è¦ç”¨æ¶ˆè¡Œä¾†æ¸…é™¤

### 3. Explosiveï¼ˆçˆ†ç‚¸æ–¹å¡Šï¼‰ğŸ’¥
- **ä¾†æº**ï¼šé—œå¡ 8ã€9ã€10 æ•µäºº AddBlock ç”Ÿæˆçš„æ–¹å¡Š
- **æ¶ˆé™¤æ•ˆæœ**ï¼šæ­£å¸¸ç”¢ç”Ÿå°å½ˆï¼ˆç©å®¶æ¶ˆè¡Œï¼‰
- **è¢«å°„æ“Šæ•ˆæœ**ï¼š
  - âš ï¸ **ç©å®¶å—åˆ° 5 é»å‚·å®³**ï¼ˆçˆ†ç‚¸å‚·å®³ï¼‰
  - æ–¹å¡Šè¢«æ‘§æ¯€
- **ç‰¹æ€§**ï¼šå±éšªæ–¹å¡Šï¼Œè¢«æ•µäººå­å½ˆæ“Šä¸­æœƒåå‚·ç©å®¶

---

## ğŸ“‹ å®Œæ•´å¯¦ç¾æ¸…å–®

### âœ… å·²å®Œæˆçš„ä¿®æ”¹

#### 1. æ•¸æ“šçµæ§‹
- [x] `GameEnums.cs` - æ·»åŠ  `BlockType` æšèˆ‰
- [x] `BlockData.cs` - æ·»åŠ  `blockType` å­—æ®µ

#### 2. æ–¹å¡Šç”Ÿæˆ
- [x] `TetrominoController.cs` - ç©å®¶æ–¹å¡Šè¨­ç‚º `Normal`
- [x] `CombatManager.cs` - AddBlock æ ¹æ“šé—œå¡ç”Ÿæˆ `Explosive` æˆ– `Normal`
- [x] `GridManager.cs` - çµ‚ç„‰æ©Ÿæ¢°ç¥æ’å…¥è¡Œè¨­ç‚º `Void`

#### 3. äº‹ä»¶ç³»çµ±
- [x] `GameEvents.cs` - `OnRowsCleared` æ”¹ç‚º `(int, bool)` ç°½å
- [x] æ‰€æœ‰è¨‚é–±è€…æ›´æ–°ç‚ºæ–°ç°½å

#### 4. è™›ç„¡æŠµéŠ·é‚è¼¯
- [x] `GridManager.CheckAndClearRows()` - æª¢æ¸¬ Void æ–¹å¡Š
- [x] `PlayerManager.HandleRowsCleared()` - è™•ç†è™›ç„¡æŠµéŠ·
- [x] `GameUI.HandleRowsClearedForSalvo()` - é¡¯ç¤º"è™›ç„¡æŠµéŠ·!"
- [x] ä¸ç™¼å°„å°å½ˆé‚è¼¯ï¼ˆåœ¨ PlayerManager ä¸­è™•ç†ï¼‰

#### 5. çˆ†ç‚¸æ–¹å¡Šé‚è¼¯
- [x] `GridManager.DamageBlock()` - æª¢æ¸¬ Explosive è¢«æ‘§æ¯€
- [x] è§¸ç™¼ç©å®¶å‚·å®³äº‹ä»¶

---

## ğŸ¯ åŠŸèƒ½è©³ç´°èªªæ˜

### Normal æ–¹å¡Šæµç¨‹

```
ç©å®¶æ”¾ç½®æ–¹å¡Š
  â†“
TetrominoController.MergePieceToGrid()
  â””â”€ BlockType.Normal
  â†“
æ¶ˆé™¤è¡Œæ™‚
  â†“
GridManager.CheckAndClearRows()
  â””â”€ hasVoid = false
  â†“
GameEvents.TriggerRowsCleared(count, false)
  â†“
PlayerManager.HandleRowsCleared(count, false)
  â””â”€ æ­£å¸¸ç”¢ç”Ÿå°å½ˆ âœ…
```

### Void æ–¹å¡Šæµç¨‹

```
çµ‚ç„‰æ©Ÿæ¢°ç¥æ’å…¥è¡Œ
  â†“
GridManager.InsertIndestructibleRow()
  â””â”€ BlockType.Void
  â””â”€ isIndestructible = true
  â†“
ç©å®¶æ¶ˆé™¤è©²è¡Œ
  â†“
GridManager.CheckAndClearRows()
  â””â”€ æª¢æ¸¬åˆ° Void æ–¹å¡Š
  â””â”€ hasVoid = true
  â†“
GameEvents.TriggerRowsCleared(count, true)
  â†“
PlayerManager.HandleRowsCleared(count, true)
  â”œâ”€ Debug: "è™›ç„¡æŠµéŠ·ï¼ä¸ç”¢ç”Ÿå°å½ˆ"
  â”œâ”€ é¡¯ç¤ºå½ˆå‡ºæ–‡å­—: "è™›ç„¡æŠµéŠ·!" (ç°è‰²)
  â””â”€ ä¸ç™¼å°„å°å½ˆ âŒ
  â†“
GameUI.HandleRowsClearedForSalvo(count, true)
  â”œâ”€ salvoText = "è™›ç„¡æŠµéŠ·!"
  â”œâ”€ color = ç°è‰²
  â””â”€ é¡¯ç¤º 2 ç§’
```

### Explosive æ–¹å¡Šæµç¨‹

```
é—œå¡ 8/9/10 æ•µäººå°„æ“Š AddBlock
  â†“
CombatManager.ProcessBulletHitGrid()
  â””â”€ currentStage >= 7 ?
      â”œâ”€ æ˜¯ â†’ BlockType.Explosive
      â””â”€ å¦ â†’ BlockType.Normal
  â†“
ç”Ÿæˆçˆ†ç‚¸æ–¹å¡Š
  â†“
ã€æƒ…æ³ Aï¼šè¢«æ•µäººå­å½ˆæ“Šä¸­ã€‘
æ•µäººå°„æ“Šå‘½ä¸­çˆ†ç‚¸æ–¹å¡Š
  â†“
GridManager.DamageBlock()
  â””â”€ block.hp <= 0 && blockType == Explosive?
      â”œâ”€ æ˜¯ â†’ GameEvents.TriggerPlayerDamaged(5)
      â”‚        â””â”€ ç©å®¶ HP -5 ğŸ’¥
      â””â”€ RemoveBlock()
  â†“
ã€æƒ…æ³ Bï¼šç©å®¶æ¶ˆè¡Œã€‘
ç©å®¶æ¶ˆé™¤åŒ…å«çˆ†ç‚¸æ–¹å¡Šçš„è¡Œ
  â†“
GridManager.ClearRows()
  â””â”€ ç›´æ¥ç§»é™¤ï¼Œä¸è§¸ç™¼çˆ†ç‚¸
  â””â”€ æ­£å¸¸ç™¼å°„å°å½ˆ âœ…
```

---

## ğŸ§ª æ¸¬è©¦å ´æ™¯

### å ´æ™¯ 1ï¼šNormal æ–¹å¡Šï¼ˆé—œå¡ 1-7ï¼‰

```
å‹•ä½œï¼š
1. ç©å®¶æ”¾ç½® T æ–¹å¡Š
2. æ¶ˆé™¤ 3 æ’

çµæœï¼š
âœ… é¡¯ç¤º "é½Šå°„ x3!"
âœ… ç™¼å°„å°å½ˆæ”»æ“Šæ•µäºº
âœ… Combo +1
```

### å ´æ™¯ 2ï¼šVoid æ–¹å¡Šï¼ˆé—œå¡ 10ï¼‰

```
å‹•ä½œï¼š
1. çµ‚ç„‰æ©Ÿæ¢°ç¥ä½¿ç”¨ InsertRow æ”»æ“Š
2. åº•éƒ¨å‡ºç¾ç°è‰²ä¸å¯æ‘§æ¯€è¡Œï¼ˆVoidï¼‰
3. ç©å®¶æ“ä½œæ¶ˆé™¤è©²è¡Œ

çµæœï¼š
âœ… é¡¯ç¤º "è™›ç„¡æŠµéŠ·!" (ç°è‰²)
âŒ ä¸ç™¼å°„å°å½ˆ
âœ… Combo +1
âœ… åˆ†æ•¸ +100
```

### å ´æ™¯ 3ï¼šExplosive æ–¹å¡Šï¼ˆé—œå¡ 8-10ï¼‰

```
å‹•ä½œï¼š
1. æ•µäººä½¿ç”¨ AddBlock æ”»æ“Š
2. ç”Ÿæˆç´…è‰²çˆ†ç‚¸æ–¹å¡Š
3. æ•µäººå°„æ“Šå‘½ä¸­è©²æ–¹å¡Š

çµæœï¼š
ğŸ’¥ ç©å®¶ HP -5ï¼ˆçˆ†ç‚¸å‚·å®³ï¼‰
âœ… æ–¹å¡Šè¢«æ‘§æ¯€
âœ… é¡¯ç¤ºçˆ†ç‚¸æ—¥èªŒ

å‹•ä½œï¼ˆå¦ä¸€ç¨®æƒ…æ³ï¼‰ï¼š
1. æ•µäººä½¿ç”¨ AddBlock æ”»æ“Š
2. ç”Ÿæˆç´…è‰²çˆ†ç‚¸æ–¹å¡Š
3. ç©å®¶æ¶ˆè¡Œæ¸…é™¤è©²æ–¹å¡Š

çµæœï¼š
âœ… æ–¹å¡Šæ­£å¸¸ç§»é™¤
âœ… ç™¼å°„å°å½ˆ
âŒ ä¸è§¸ç™¼çˆ†ç‚¸ï¼ˆåªæœ‰è¢«å°„æ“Šæ‰çˆ†ç‚¸ï¼‰
```

### å ´æ™¯ 4ï¼šæ··åˆæ¶ˆé™¤

```
å‹•ä½œï¼š
1. å ´ä¸Šæœ‰ 2 æ’æ··åˆæ–¹å¡Šï¼š
   - ç¬¬ 18 æ’ï¼šNormal æ–¹å¡Š
   - ç¬¬ 19 æ’ï¼šVoid æ–¹å¡Šï¼ˆçµ‚ç„‰æ©Ÿæ¢°ç¥æ’å…¥ï¼‰
2. ç©å®¶åŒæ™‚æ¶ˆé™¤é€™å…©æ’

çµæœï¼š
âœ… æ¶ˆé™¤ 2 æ’
âœ… æª¢æ¸¬åˆ°åŒ…å« Void æ–¹å¡Š
âœ… é¡¯ç¤º "è™›ç„¡æŠµéŠ·!"
âŒ ä¸ç™¼å°„å°å½ˆï¼ˆå³ä½¿æœ‰ Normal æ–¹å¡Šï¼‰
âœ… Combo +1
```

---

## ğŸ“Š é—œå¡é›£åº¦æ›²ç·š

### é—œå¡ 1-7ï¼šæ¨™æº–é›£åº¦
- **æ•µäººæ–¹å¡Š**ï¼šNormal
- **ç©å®¶é«”é©—**ï¼šæ¨™æº–ä¿„ç¾…æ–¯æ–¹å¡Š + æˆ°é¬¥

### é—œå¡ 8-9ï¼šé«˜é›£åº¦
- **æ•µäººæ–¹å¡Š**ï¼šExplosive
- **æ–°æŒ‘æˆ°**ï¼š
  - éœ€è¦é¿å…æ•µäººå°„æ“Šè‡ªå·±çš„æ–¹å¡Š
  - è¢«æ“Šä¸­çˆ†ç‚¸æ–¹å¡Šæœƒå—åˆ°é¡å¤–å‚·å®³
  - é¼“å‹µç©å®¶å¿«é€Ÿæ¶ˆè¡Œæ¸…é™¤

### é—œå¡ 10ï¼šçµ‚æ¥µæŒ‘æˆ°
- **æ•µäººæ–¹å¡Š**ï¼šExplosive + Voidï¼ˆçµ‚ç„‰æ©Ÿæ¢°ç¥ï¼‰
- **æœ€å¤§æŒ‘æˆ°**ï¼š
  - çˆ†ç‚¸æ–¹å¡Šå¨è„…æŒçºŒå­˜åœ¨
  - è™›ç„¡è¡Œç„¡æ³•ç”¨å°å½ˆæ¸…é™¤
  - å¿…é ˆç”¨æ¶ˆè¡Œä¾†å°æŠ—è™›ç„¡è¡Œ
  - è³‡æºç®¡ç†æ›´åŠ é‡è¦

---

## ğŸ¨ è¦–è¦ºå€åˆ†å»ºè­°

### æ–¹å¡Šé¡è‰²å»ºè­°

```csharp
Normal æ–¹å¡Šï¼š
  - ä¿æŒåŸæœ‰é¡è‰²ï¼ˆé’ã€é»ƒã€ç´«ç­‰ï¼‰
  - ç„¡ç‰¹æ®Šæ•ˆæœ

Void æ–¹å¡Šï¼š
  - é¡è‰²ï¼šæ·±ç°è‰² (#404040)
  - æ•ˆæœï¼šè¼•å¾®çš„æš—å½±æˆ–æ¼©æ¸¦å‹•ç•«
  - æç¤ºï¼šä¸å¯æ‘§æ¯€æ¨™è¨˜

Explosive æ–¹å¡Šï¼š
  - é¡è‰²ï¼šæš—ç´…è‰² (#8B0000) æˆ–æ©™ç´…æ¼¸è®Š
  - æ•ˆæœï¼šè„ˆå‹•å…‰æšˆã€ç«èŠ±ç‰¹æ•ˆ
  - æç¤ºï¼šå±éšªæ¨™è¨˜ï¼ˆâš ï¸ æˆ– ğŸ’¥ï¼‰
```

### UI æ–‡å­—é¡è‰²

```
"é½Šå°„ xN!" â†’ é’è‰² (Cyan)
"è¶…ç´šé½Šå°„ xN!" â†’ é‡‘è‰² (Gold)
"è™›ç„¡æŠµéŠ·!" â†’ ç°è‰² (Gray)
```

---

## ğŸ› å·²çŸ¥å•é¡Œå’Œæ³¨æ„äº‹é …

### 1. æ¶ˆé™¤å„ªå…ˆç´š
- å¦‚æœä¸€æ¬¡æ¶ˆé™¤åŒæ™‚åŒ…å« Normal å’Œ Void æ–¹å¡Š
- çµæœï¼šè¦–ç‚ºè™›ç„¡æŠµéŠ·ï¼Œä¸ç”¢ç”Ÿå°å½ˆ
- é€™æ˜¯**è¨­è¨ˆæ„åœ–**ï¼Œé¼“å‹µç©å®¶åˆ†é–‹è™•ç†

### 2. çˆ†ç‚¸æ–¹å¡Šå‚·å®³
- åªæœ‰è¢«**æ•µäººå­å½ˆ**æ“Šä¸­æ‰çˆ†ç‚¸
- ç©å®¶æ¶ˆè¡Œæ¸…é™¤ä¸æœƒçˆ†ç‚¸
- ç©å®¶è‡ªå·±çš„å°å½ˆæ“Šä¸­ä¸æœƒçˆ†ç‚¸

### 3. è™›ç„¡æ–¹å¡Šç‰¹æ€§
- ä¸å¯æ‘§æ¯€ï¼ˆisIndestructible = trueï¼‰
- åªèƒ½é€šéæ¶ˆè¡Œæ¸…é™¤
- å³ä½¿æ¶ˆé™¤ 1 æ’ä¹Ÿé¡¯ç¤ºæç¤º

---

## ğŸ“ ä»£ç¢¼ä¿®æ”¹æ‘˜è¦

### ä¿®æ”¹çš„æ–‡ä»¶åˆ—è¡¨
1. `Assets/Scripts/Data/GameEnums.cs`
2. `Assets/Scripts/Data/BlockData.cs`
3. `Assets/Scripts/Core/GameEvents.cs`
4. `Assets/Scripts/Gameplay/Tetromino/TetrominoController.cs`
5. `Assets/Scripts/Managers/GridManager.cs`
6. `Assets/Scripts/Managers/CombatManager.cs`
7. `Assets/Scripts/Managers/PlayerManager.cs`
8. `Assets/Scripts/UI/GameUI.cs`

### æ–°å¢çš„åŠŸèƒ½é»
- BlockType æšèˆ‰ï¼ˆ3 ç¨®é¡å‹ï¼‰
- è™›ç„¡æŠµéŠ·æ©Ÿåˆ¶
- çˆ†ç‚¸å‚·å®³æ©Ÿåˆ¶
- é—œå¡é›£åº¦åˆ†ç´š

### Debug æ—¥èªŒ
```
[GridManager] æ¶ˆé™¤åŒ…å«è™›ç„¡æ–¹å¡Šçš„è¡Œï¼Œå°‡è§¸ç™¼è™›ç„¡æŠµéŠ·
[PlayerManager] è™›ç„¡æŠµéŠ·ï¼ä¸ç”¢ç”Ÿå°å½ˆ
[GridManager] çˆ†ç‚¸æ–¹å¡Šåœ¨ (3, 15) è¢«æ‘§æ¯€ï¼ç©å®¶å—åˆ° 5 é»å‚·å®³
[CombatManager] æ•µäººæ·»åŠ æ–¹å¡Šå½¢æˆå®Œæ•´è¡Œï¼æ¶ˆé™¤äº† 1 è¡Œ
```

---

## âœ… å®Œæˆç¢ºèª

- [x] BlockType æšèˆ‰å®šç¾©
- [x] BlockData çµæ§‹æ“´å±•
- [x] Normal æ–¹å¡Šå¯¦ç¾
- [x] Void æ–¹å¡Šå¯¦ç¾
- [x] Explosive æ–¹å¡Šå¯¦ç¾
- [x] äº‹ä»¶ç³»çµ±æ›´æ–°
- [x] è™›ç„¡æŠµéŠ·é‚è¼¯
- [x] çˆ†ç‚¸å‚·å®³é‚è¼¯
- [x] UI é¡¯ç¤ºæ›´æ–°
- [x] é—œå¡é›£åº¦åˆ†ç´š

**ç³»çµ±ç‹€æ…‹ï¼šâœ… å®Œæ•´å¯¦ç¾ä¸¦æ¸¬è©¦é€šé**

---

## ğŸ® ç©å®¶é«”é©—ç¸½çµ

### ç­–ç•¥æ·±åº¦
- **é—œå¡ 1-7**ï¼šæ¨™æº–ç©æ³•ï¼Œç†Ÿæ‚‰ç³»çµ±
- **é—œå¡ 8-9**ï¼šé¢¨éšªèˆ‡å›å ±ï¼Œéœ€è¦å¿«é€Ÿåæ‡‰
- **é—œå¡ 10**ï¼šè³‡æºç®¡ç†ï¼Œéœ€è¦ç­–ç•¥è¦åŠƒ

### æŒ‘æˆ°æ€§
- Explosive æ–¹å¡Šå¢åŠ ç·Šè¿«æ„Ÿ
- Void æ–¹å¡Šå¢åŠ ç­–ç•¥æ€§
- å…©è€…çµåˆæä¾›æ¥µè‡´æŒ‘æˆ°

### è¶£å‘³æ€§
- å¤šæ¨£åŒ–çš„æ–¹å¡Šé¡å‹
- ä¸åŒçš„æ‡‰å°ç­–ç•¥
- æ˜ç¢ºçš„è¦–è¦ºåé¥‹

**æ–¹å¡Šé¡å‹ç³»çµ±å·²å®Œæ•´å¯¦ç¾ï¼** ğŸ‰âœ¨


