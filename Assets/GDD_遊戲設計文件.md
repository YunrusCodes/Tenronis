# Tenronis - 俄羅斯加農砲
# 遊戲設計文件 (Game Design Document)

**版本**: 1.0  
**最後更新**: 2025年11月26日  
**開發平台**: Unity 6  
**類型**: 動作益智射擊遊戲  
**目標平台**: PC / Web

---

## 📋 目錄

1. [遊戲概述](#遊戲概述)
2. [核心概念](#核心概念)
3. [遊戲機制](#遊戲機制)
4. [戰鬥系統](#戰鬥系統)
5. [方塊類型系統](#方塊類型系統)
6. [關卡設計](#關卡設計)
7. [升級與進程系統](#升級與進程系統)
8. [技能系統](#技能系統)
9. [視覺設計](#視覺設計)
10. [音效設計](#音效設計)
11. [UI/UX設計](#uiux設計)
12. [遊戲平衡性](#遊戲平衡性)
13. [技術架構](#技術架構)
14. [未來擴展](#未來擴展)

---

## 🎮 遊戲概述

### 高概念 (High Concept)

**"俄羅斯方塊遇上彈幕射擊"**

Tenronis是一款創新的混合型遊戲，將經典的俄羅斯方塊益智玩法與緊張刺激的彈幕射擊元素完美融合。玩家不僅要堆疊方塊，更要將每一次消行轉化為強力火力，擊敗層層襲來的敵人。

### 核心體驗

玩家將體驗到：
- **策略決策**：每次方塊放置都影響攻守平衡
- **高速操作**：在敵人火力下快速調整方塊
- **風險回報**：追求連擊獲得更高傷害，或保守防守
- **成長感**：通過Roguelike升級系統不斷變強
- **挑戰性**：20個難度遞增的關卡和4個Boss戰

### 目標玩家

- **核心玩家**：喜愛俄羅斯方塊的益智遊戲玩家
- **動作玩家**：喜愛彈幕射擊和快節奏遊戲的玩家
- **Roguelike愛好者**：享受隨機性和成長系統的玩家
- **休閒玩家**：尋找有深度且易上手的遊戲

### 遊戲時長

- **單局遊戲**：30-60分鐘
- **完整通關（20關）**：2-4小時
- **精通遊戲**：20+小時

---

## 💡 核心概念

### 遊戲循環 (Game Loop)

```
方塊下落
    ↓
玩家操控 (移動/旋轉/硬降)
    ↓
放置並鎖定方塊
    ↓
檢測消除
    ↓
發射導彈攻擊敵人 ← 核心創新點
    ↓
敵人發射子彈攻擊方塊 ← 雙向戰鬥
    ↓
方塊承受傷害
    ↓
累積傷害獲得升級 ← Roguelike元素
    ↓
選擇Buff強化能力
    ↓
進入下一回合
```

### 三大支柱

#### 1. 益智策略 (Puzzle Strategy)
- 俄羅斯方塊的經典堆疊玩法
- 需要規劃放置位置以最大化消除
- 空洞管理和方塊高度控制

#### 2. 戰鬥節奏 (Combat Rhythm)
- 消除行數決定火力輸出
- 連擊系統提升傷害
- 承受敵人攻擊需要方塊防守

#### 3. 成長系統 (Progression System)
- Roguelike隨機升級
- 10種Buff構建不同流派（6普通+4傳奇）
- 技能解鎖增加戰術選擇（需TacticalExpansion解鎖）

### 獨特賣點 (USP)

1. **攻守一體**：方塊既是武器也是護盾
2. **即時反饋**：每次消除立即看到戰鬥效果
3. **策略深度**：Buff組合產生多樣化玩法
4. **高重玩性**：每局不同的升級路徑

---

## ⚙️ 遊戲機制

### 1. 俄羅斯方塊系統

#### 方塊形狀
遊戲包含7種經典俄羅斯方塊（Tetromino）：

| 形狀 | 名稱 | 尺寸 | 特點 |
|------|------|------|------|
| I | 直線方塊 | 4x1 | 消除四行的利器 |
| O | 正方形方塊 | 2x2 | 無法旋轉，穩定防守 |
| T | T型方塊 | 3x2 | 最常見，旋轉靈活 |
| S | S型方塊 | 3x2 | 製造不規則結構 |
| Z | Z型方塊 | 3x2 | S的鏡像 |
| J | J型方塊 | 3x2 | L型變體 |
| L | L型方塊 | 3x2 | J的鏡像 |

#### 操作控制
- **← / →**：左右移動
- **↑**：順時針旋轉90度
- **↓**：加速下落（Soft Drop）
- **Space**：硬降（Hard Drop）- 立即放置

#### 下落規則
- **自動下落速度**：根據關卡難度調整（0.5秒 - 1.0秒）
- **鎖定延遲**：方塊接觸地面或其他方塊後，有短暫時間可調整位置
- **牆壁踢**：旋轉時若碰撞，自動嘗試偏移避免失敗

#### 消除規則
- 一次可消除1-4行
- 消除多行獲得額外獎勵（齊射系統）
- 消除速度：行同時消失（無下落動畫）

### 2. 網格系統

#### 遊戲區域
- **尺寸**：10格（寬）× 20格（高）
- **可見區域**：完整20格
- **危險線**：頂部3格為警告區域

#### 方塊狀態
每個網格格子可能處於三種狀態：
- **空**：可放置方塊
- **已佔用**：有方塊存在
- **不可摧毀**：特殊方塊（Boss技能）

### 3. Combo系統

#### 連擊機制
- **累積條件**：連續消除行（不中斷）
- **中斷條件**：
  - 3秒內未消除行
  - 玩家HP歸零
- **計數顯示**：UI實時顯示當前Combo數

#### Combo獎勵
- **傷害加成**：Combo數 × 連發等級 × 0.25
- **視覺反饋**：高Combo時顯示特殊效果
- **分數加成**：Combo越高分數倍率越大

### 4. 分數系統

#### 分數來源
| 行為 | 基礎分數 |
|------|---------|
| 消除1行 | 100 |
| 消除2行 | 300 |
| 消除3行 | 500 |
| 消除4行 | 800 |
| 擊中敵人 | 每點傷害 × 10 |
| Combo加成 | 分數 × (1 + Combo × 0.1) |

---

## ⚔️ 戰鬥系統

### 1. 導彈系統（玩家攻擊）

#### 發射機制
- **觸發條件**：消除完整行
- **發射數量**：每個位置發射 (1 + 協同火力等級) 個導彈
  - 基礎：每個位置1個導彈
  - 協同火力（Volley）：每個位置額外 +1 導彈/等級
- **發射位置**：從消除的行每個位置向上發射
- **飛行速度**：15 單位/秒

#### 傷害計算公式

```
基礎傷害 = 2

齊射加成 = (消除行數 - 1) × 齊射強化等級（Salvo） × 0.5

連發加成 = Combo數 × 連發等級 × 0.25

單發導彈傷害 = 基礎傷害 + 齊射加成 + 連發加成

每個位置導彈數 = 1 + 協同火力等級（Volley）

總導彈數 = 消除行數 × 10位置 × 每個位置導彈數
```

#### 範例計算
```
情況：消除3行，Combo 5，協同火力等級2，齊射強化等級2，連發等級3

基礎傷害 = 2
齊射加成 = (3 - 1) × 2 × 0.5 = 2（來自Salvo齊射強化）
連發加成 = 5 × 3 × 0.25 = 3.75

單發導彈傷害 = 2 + 2 + 3.75 = 7.75
每個位置導彈數 = 1 + 2 = 3（來自Volley協同火力）
總導彈數 = 3行 × 10位置 × 3導彈 = 90發
總傷害 = 90 × 7.75 = 697.5
```

#### 視覺效果
- **顏色**：青藍色
- **軌跡**：發光拖尾
- **擊中特效**：爆炸動畫（待實作）

### 2. 子彈系統（敵人攻擊）

#### 子彈類型

遊戲共有**8種子彈類型**，隨著關卡推進逐步解鎖，每種子彈都有獨特的效果和戰術意義。

##### Type 1: Normal（普通子彈）🔴
- **效果**：對方塊造成1點傷害
- **出現關卡**：所有關卡
- **速度**：基礎速度（5-11 單位/秒，依關卡而定）
- **顏色**：紅色 (RGB: 240, 69, 69)
- **戰術定位**：基礎攻擊，穩定威脅

##### Type 2: AreaDamage（範圍傷害）🟣
- **效果**：對3x3範圍內所有方塊造成傷害
- **出現關卡**：Stage 6+
- **傷害**：中心2點，周圍1點
- **顏色**：橙色 (RGB: 250, 115, 33)
- **戰術定位**：區域清除，威脅密集方塊結構

##### Type 3: AddBlock（添加普通方塊）🟢
- **效果**：在擊中位置上方生成普通方塊
- **出現關卡**：Stage 7+
- **特殊機制**：
  - 如果生成方塊形成完整行，立即消除
  - 智能瞄準：優先攻擊高處（`addBlockTargetsHigh`）
- **顏色**：綠色 (RGB: 74, 222, 128)
- **戰術定位**：增加方塊堆疊壓力

##### Type 4: AddExplosiveBlock（添加爆炸方塊）🟡
- **效果**：在擊中位置上方生成爆炸方塊
- **出現關卡**：Stage 8+
- **特殊機制**：
  - 生成的爆炸方塊被擊中時玩家受5點傷害
  - 與AddBlock相同的生成邏輯
- **顏色**：黃色 (RGB: 255, 235, 4)
- **戰術定位**：雙重威脅，逼迫玩家快速消行

##### Type 5: InsertRow（插入普通垃圾行）🟣
- **效果**：在底部插入一整行普通方塊
- **出現關卡**：Stage 12+
- **特性**：
  - 直接佔據底部空間
  - 可用消行清除
- **顏色**：紫色 (RGB: 168, 84, 247)
- **戰術定位**：強制壓縮玩家空間

##### Type 6: InsertVoidRow（插入虛無垃圾行）⚫
- **效果**：在底部插入一整行虛無方塊
- **出現關卡**：Stage 18+（終局關卡）
- **特性**：
  - 虛無方塊不可被子彈摧毀
  - 只能通過消行清除
  - 消行時不發射導彈（虛無抵銷）
- **顏色**：深灰色 (RGB: 51, 51, 51)
- **戰術定位**：抵銷玩家火力，最高威脅等級

##### Type 7: CorruptExplosive（腐化：爆炸）🟣💥
- **效果**：將下一個即將放置的方塊的隨機一格變成爆炸方塊
- **出現關卡**：Stage 10+（Boss關卡）
- **特殊機制**：
  - 直接改變玩家控制的方塊
  - 被腐化的格子變成爆炸方塊
  - 無法預防，只能通過快速消行應對
- **顏色**：洋紅色 (RGB: 255, 0, 255)
- **戰術定位**：破壞玩家計劃，製造不確定性

##### Type 8: CorruptVoid（腐化：虛無）🔵🌀
- **效果**：將下一個即將放置的方塊的隨機一格變成虛無方塊
- **出現關卡**：Stage 5+（特殊Boss引入）
- **特殊機制**：
  - 直接改變玩家控制的方塊
  - 被腐化的格子變成虛無方塊
  - 無法摧毀，削弱火力輸出
- **顏色**：青色 (RGB: 0, 255, 255)
- **戰術定位**：最高難度機制，限制玩家攻擊能力

#### 子彈類型解鎖時間表

| 子彈類型 | 首次出現 | 普及階段 | 戰術意義 |
|---------|---------|---------|---------|
| Normal | Stage 1 | 全關卡 | 基礎威脅 |
| CorruptVoid | Stage 5 | Boss關卡 | 首次腐化體驗 |
| AddBlock | Stage 6 | Stage 6+ | 增加堆疊壓力 |
| AreaDamage | Stage 7 | Stage 7+ | 區域清除威脅 |
| AddExplosiveBlock | Stage 8 | Stage 8+ | 雙重傷害威脅 |
| CorruptExplosive | Stage 10 | Boss關卡 | 高難度腐化 |
| InsertRow | Stage 12 | Stage 12+ | 空間壓迫 |
| InsertVoidRow | Stage 14 | Stage 14+ | 火力抵銷 |

**設計哲學**：
- **階段性解鎖**：每個階段引入1-2種新子彈類型
- **漸進式難度**：從簡單的傷害到複雜的腐化和空間控制
- **組合威脅**：後期關卡（16-20）同時使用全部8種子彈

#### 射擊模式
- **單發模式**：一次射擊1發子彈（基礎）
- **散射模式**：同時發射多發子彈（3-5發）
- **連發模式**：快速連續射擊（後期關卡）
- **智能瞄準**：Stage 15+啟用，優先攻擊高/低處（`useSmartTargeting`）

### 3. 方塊HP系統

#### HP機制
- **初始HP**：1 + 防禦等級
- **受到傷害**：子彈擊中減少HP
- **摧毀條件**：HP降至0
- **視覺反饋**：方塊上顯示數字或顏色深度

#### HP升級
- **來源**：防禦Buff
- **效果**：+1 HP / 等級
- **最大值**：理論無上限

### 4. 反擊系統

#### 觸發條件
- **時間窗口**：方塊放置後0.2秒內
- **受擊條件**：被敵人子彈擊中
- **等級需求**：反擊等級 ≥ 1

#### 反擊效果
- **發射數量**：反擊等級
- **傷害**：與普通導彈相同
- **特殊性**：維持Combo不中斷
- **視覺**：金色導彈（區別於一般導彈）

#### 策略意義
- 鼓勵在敵人攻擊時機放置方塊
- 提供主動防守的玩法選擇
- 高風險高回報的操作

### 5. 溢出懲罰與爆炸充能系統

#### 懲罰條件
- **觸發**：方塊放置時超出頂部邊界
- **後果**：
  1. 消耗25 CP（CP不足時HP降至1）
  2. 該方塊不放置（消失）
  3. Combo中斷
  4. 清空網格

#### 爆炸充能系統
- **初始充能上限**：200
- **充能獲得方式**：
  - 反擊一次：+5充能
  - 消排一次：+50充能
- **Explosion Buff效果**：
  - 每次選擇充能上限+200
  - 起始等級1，最高等級4
  - 最多可達1000充能上限
- **溢出傷害**：
  - 溢出時對敵人造成當前充能值的傷害
  - 傷害後充能歸零
- **策略**：將懲罰轉化為攻擊手段，需要累積充能

---

## 🎲 方塊類型系統

### 1. Normal 方塊（普通方塊）✅

#### 特性
- **來源**：
  - 玩家放置的所有方塊
  - 關卡1-7敵人AddBlock生成
- **顏色**：依方塊形狀（青、黃、紫、綠、紅、藍、橙）
- **HP**：1 + 防禦等級
- **可摧毀**：是
- **消除效果**：正常發射導彈

#### 戰術定位
- 基礎戰鬥單位
- 平衡的攻守性能
- 遊戲前期主要方塊類型

### 2. Void 方塊（虛無方塊）🌀

#### 特性
- **來源**：
  - 由InsertVoidRow子彈插入（Stage 14+）
  - 由CorruptVoid腐化生成（Stage 5+）
- **顏色**：深灰色 (#404040)
- **HP**：∞（不可摧毀）
- **可摧毀**：否（子彈無效）
- **消除效果**：
  - ❌ **不發射導彈**
  - 顯示"虛無抵銷!" 而非 "齊射 xN"
  - 仍獲得分數和Combo

#### 虛無抵銷機制
```
消除行檢測
    ↓
是否包含Void方塊？
    ├─ 是 → 虛無抵銷
    │        ├─ 顯示灰色提示
    │        ├─ 不發射導彈
    │        └─ Combo +1
    └─ 否 → 正常齊射
             ├─ 發射導彈
             └─ 攻擊敵人
```

#### 戰術定位
- **Boss專屬機制**
- **挑戰性**：
  - 強制玩家用消行清除（無法用火力）
  - 佔據底部空間施加壓力
  - 抵銷玩家火力輸出
- **策略應對**：
  - 保持底部空間清潔
  - 準備好快速消行的方塊
  - 利用處決技能清理

#### 視覺設計建議
- 暗影漩渦動畫
- 不可摧毀標記（盾牌圖示）
- 受到攻擊時顯示"無效"文字

### 3. Explosive 方塊（爆炸方塊）💥

#### 特性
- **來源**：
  - 關卡8-10敵人AddBlock生成
- **顏色**：暗紅色 (#8B0000) 或橙紅漸變
- **HP**：1（與Normal相同）
- **可摧毀**：是
- **消除效果**：
  - 玩家消行時：正常發射導彈 ✅
  - 被子彈擊中時：⚠️ **玩家受到5點傷害**

#### 爆炸機制
```
爆炸方塊被子彈擊中
    ↓
HP降至0
    ↓
觸發爆炸
    ↓
玩家HP -5
    ↓
方塊摧毀
    ↓
顯示爆炸特效
```

#### 戰術定位
- **高難度挑戰元素**
- **雙刃劍**：
  - 為玩家：是額外的HP威脅
  - 為敵人：攻擊自己的方塊會反傷玩家
- **策略應對**：
  - 快速消行清除（不觸發爆炸）
  - 提高方塊防禦避免被擊破
  - 利用方塊遮擋保護爆炸方塊

#### 視覺設計建議
- 脈動紅光效果
- 火花粒子特效
- 危險標記（⚠️ 或 💥）
- 爆炸時大範圍衝擊波動畫

### 方塊類型對照表

| 類型 | 來源 | HP | 摧毀 | 消除發射導彈 | 被擊中效果 | 難度 |
|------|------|----|----|------------|----------|------|
| Normal | 玩家/敵人(1-7) | 1+ | ✅ | ✅ | 減少HP | ★☆☆ |
| Void | Boss(10) | ∞ | ❌ | ❌ | 無效 | ★★★ |
| Explosive | 敵人(8-10) | 1 | ✅ | ✅ | 玩家-5 HP | ★★☆ |

### 難度曲線設計

#### 方塊類型分布

| 階段 | 關卡 | 方塊類型 | 來源 |
|------|------|---------|------|
| 一 | 1-4 | Normal | 玩家放置 |
| 一 | 5 | Normal + Void | 玩家 + CorruptVoid |
| 二 | 6-7 | Normal | 玩家 + AddBlock |
| 二 | 8-10 | Normal + Explosive | 玩家 + AddExplosive + Corrupt |
| 三 | 11-14 | Normal + Explosive + Void | 所有來源 |
| 四 | 15-20 | Normal + Explosive + Void | 所有來源(高頻) |

**學習曲線**：
- Stage 1-5：平緩（僅Normal方塊）
- Stage 6-10：中等（引入爆炸和腐化）
- Stage 11-15：陡峭（虛無行壓迫）
- Stage 16-20：極高（全機制組合）

---

## 🎯 關卡設計

### 關卡結構

遊戲共包含**20個關卡**，每個關卡對應一個深淵生物敵人。其中關卡5、10、15、20為Boss關卡，擁有更高的HP和獎勵。

### 關卡參數

| 關卡 | 敵人名稱 | Boss | HP | 射擊間隔 | 子彈速度 | 獎勵 | 主要子彈類型 |
|------|---------|------|-----|---------|---------|------|------------|
| 1 | 深淵盜觀者 | - | 120 | 3.0s | 5 | 1 | Normal |
| 2 | 虛空彈怪 | - | 160 | 2.8s | 5.5 | 1 | Normal |
| 3 | 觸手巡海者 | - | 240 | 2.6s | 6 | 1 | Normal |
| 4 | 深海強化體 | - | 300 | 2.5s | 6.5 | 1 | Normal |
| 5 | 質變之神 | ⭐ | 400 | 2.4s | 7 | 1 | Normal, CorruptVoid |
| 6 | 古老守衝 | - | 500 | 2.3s | 7 | 1 | Normal, AddBlock |
| 7 | 多眼分裂魔 | - | 600 | 2.2s | 7.5 | 1 | Normal, Area, AddBlock |
| 8 | 深淵破壞者 | - | 700 | 2.1s | 7.5 | 1 | Normal, Area, AddExplosive |
| 9 | 深淵爆裂者 | - | 900 | 2.0s | 8 | 1 | Normal, Area, AddBlock, AddExplosive |
| 10 | 虛空主宰 | ⭐ | 1000 | 1.9s | 8 | 1 | Normal, Area, AddBlock, Corrupt× |
| 11 | 深淵全能者 | - | 1200 | 1.8s | 8.5 | 2 | Normal, Area, AddBlock, AddExplosive |
| 12 | 深淵巨眼 | - | 1400 | 1.7s | 8.5 | 2 | Normal, Area, AddBlock, AddRow |
| 13 | 混沌之子 | - | 1600 | 1.6s | 9 | 2 | + AddExplosive, CorruptExplosive |
| 14 | 深淵毒氣 | - | 1800 | 1.5s | 9 | 2 | + AddVoidRow, Corrupt× |
| 15 | 深淵狩獵者 | ⭐ | 2000 | 1.5s | 9.5 | 2 | 多種高級子彈 |
| 16 | 古老戰爭魔像 | - | 2200 | 1.4s | 9.5 | 2 | 全部8種(智能瞄準) |
| 17 | 深淵殺戮者 | - | 2600 | 1.3s | 10 | 2 | 全部8種 |
| 18 | 深淵毀滅者 | - | 3000 | 1.2s | 10 | 2 | 全部8種 |
| 19 | 深淵終結者 | - | 3600 | 1.1s | 10.5 | 3 | 全部8種(高頻) |
| 20 | 深淵主宰 | ⭐ | 5000 | 1.0s | 11 | 3 | 全部8種(最強) |

**說明**：
- **Boss**：⭐標記的關卡為Boss關卡，難度和獎勵更高
- **獎勵**：擊敗後獲得的Buff選擇次數
- **Corrupt×**：包含CorruptExplosive和CorruptVoid

### 關卡設計理念

遊戲分為**4個階段**，每個階段5關，並在每個階段末設置Boss關卡。

#### 第一階段（Stage 1-5）：深淵入門 🌊
- **目標**：讓玩家熟悉基礎操作和核心機制
- **難度曲線**：
  - Stage 1-4：僅使用Normal子彈，射擊間隔較長（2.5-3.0s）
  - Stage 5（Boss）：引入CorruptVoid腐化機制，首次Boss挑戰
- **子彈類型解鎖**：Normal → CorruptVoid
- **新機制**：
  - 基礎方塊堆疊
  - 消除發射導彈
  - 首次體驗腐化系統
- **升級建議**：Defense、Volley、Salvo

#### 第二階段（Stage 6-10）：進階戰術 🔥
- **目標**：引入多樣化攻擊模式
- **難度曲線**：
  - Stage 6-7：引入AddBlock和AreaDamage
  - Stage 8-9：引入AddExplosiveBlock（爆炸方塊威脅）
  - Stage 10（Boss）：腐化技能全解鎖，綜合性Boss
- **子彈類型解鎖**：AddBlock → AreaDamage → AddExplosiveBlock → CorruptExplosive
- **新機制**：
  - 區域傷害需要方塊佈局策略
  - 爆炸方塊雙重威脅
  - 腐化系統完整體驗
- **升級建議**：Burst、Counter、TacticalExpansion

#### 第三階段（Stage 11-15）：深淵試煉 💀
- **目標**：測試玩家綜合能力和策略深度
- **難度曲線**：
  - Stage 11-12：引入InsertRow（垃圾行壓迫）
  - Stage 13-14：引入InsertVoidRow（虛無行壓迫）
  - Stage 15（Boss）：多種高級子彈組合，獎勵2個Buff
- **子彈類型解鎖**：InsertRow → InsertVoidRow
- **新機制**：
  - 底部空間壓迫
  - 虛無行抵銷火力
  - 需要主動技能應對
- **升級建議**：ResourceExpansion、Explosion、技能流派
- **獎勵提升**：從Stage 11開始每關2個Buff獎勵

#### 第四階段（Stage 16-20）：終極深淵 ⚫
- **目標**：終極挑戰，所有機制集大成
- **難度曲線**：
  - Stage 16-18：啟用全部8種子彈類型，智能瞄準
  - Stage 19：最高難度常規關卡，獎勵3個Buff
  - Stage 20（最終Boss）：最高HP（5000），最快射速（1.0s），全子彈類型
- **子彈類型**：全部8種，高頻率出現
- **新機制**：
  - 智能瞄準（`useSmartTargeting`）
  - 極高射速和多樣化攻擊
  - 需要完美的Buff組合和操作
- **升級建議**：傳奇強化（Defense、Volley無限疊加）
- **獎勵提升**：Stage 19-20獎勵3個Buff

### 關卡過渡

#### 勝利條件
- 敵人HP降至0

#### 過渡流程
```
擊敗敵人
    ↓
勝利動畫
    ↓
檢查是否有升級點
    ↓
├─ 有 → 顯示升級選單
│         └─ 選擇Buff
└─ 無 → 直接進入下一關
    ↓
載入下一關卡數據
    ↓
重置網格（保留部分方塊？可選）
    ↓
開始新關卡
```

### 難度平衡

#### 增長曲線
- **HP增長**：指數型（前期慢，後期快）
- **射速增長**：線性（穩定遞減間隔）
- **火力增長**：階段型（特定關卡解鎖新能力）

#### 玩家成長匹配
- 升級系統確保玩家火力跟上敵人HP
- 平均需要1.5-2個升級才能擊敗下一關
- 提供多次升級選擇保證成長路徑

---

## 📊 升級與進程系統

### Roguelike升級機制

#### 升級點獲得
- **觸發條件**：對敵人造成傷害
- **獲得公式**：
  ```
  初始需求 = 50點傷害
  每次升級後需求 += 5
  
  範例：
  第1次升級：50傷害
  第2次升級：55傷害
  第3次升級：60傷害
  ```

#### 升級流程
```
累積傷害達到需求
    ↓
暫停遊戲
    ↓
顯示升級選單
    ↓
隨機展示3個Buff選項
    ↓
玩家選擇1個
    ↓
應用Buff效果
    ↓
檢查是否達到滿級
    ├─ 是 → 提供傳奇強化選擇機會
    └─ 否 → 繼續遊戲
```

#### 傳奇強化選擇機制

**觸發條件**：
- 當選擇的普通強化使其達到滿級時
- 且之前沒有其他普通強化已滿級

**選擇規則**：
- 只從傳奇強化（Legendary Buffs）陣列中選擇
- 如果傳奇強化數量 ≤ 3：直接顯示全部（不隨機選擇）
- 如果傳奇強化數量 > 3：隨機選擇3個（根據權重）
- 不會過濾傳奇強化（除了null），保留所有內容

**分類說明**：
- **普通強化**：有上限等級的強化（Salvo, Burst, Counter, Explosion, SpaceExpansion, ResourceExpansion）
- **傳奇強化**：無上限或特殊效果的強化（Defense, Volley, TacticalExpansion）

### 傳奇強化系統設計

#### 設計理念

傳奇強化是遊戲中的高級成長選項，旨在為玩家提供長期發展的目標和無限成長的可能性。

**核心特點**：
1. **無上限成長**：部分傳奇強化可以無限疊加，為玩家提供持續的成長動力
2. **特殊效果**：部分傳奇強化具有獨特的立即效果或特殊機制
3. **稀有性**：只有在普通強化達到滿級時才能選擇，增加策略性
4. **視覺區分**：在UI中顯示為金色，標記為"⭐傳奇強化⭐"

#### 傳奇強化列表

| 強化名稱 | 效果 | 起始等級 | 上限 | 特點 |
|---------|------|---------|------|------|
| Defense（裝甲強化） | +1 方塊HP/等級 | 0 | 無上限 | 生存流核心，可無限疊加 |
| Volley（協同火力） | +1 導彈/位置/等級 | 0 | 無上限 | 火力流核心，可無限疊加 |
| TacticalExpansion（戰術擴展） | 解鎖技能 | 0 | 2級 | Lv1解鎖處決，Lv2解鎖修補 |

#### 與普通強化的區別

| 特性 | 普通強化 | 傳奇強化 |
|------|---------|---------|
| **上限等級** | 有上限（3-6級） | 無上限或特殊效果 |
| **獲得時機** | 每次升級都可選擇 | 僅在普通強化滿級時 |
| **成長曲線** | 有限成長，達到上限後不再出現 | 無限成長或立即效果 |
| **策略定位** | 中期核心能力 | 後期無限成長或關鍵轉折 |
| **視覺標記** | 普通顯示 | 金色⭐標記 |

#### 設計目的

1. **延長遊戲壽命**：無上限成長讓玩家有持續的目標
2. **增加策略深度**：需要規劃哪些普通強化先達到滿級
3. **提供成就感**：達到滿級後獲得傳奇強化選擇，給予玩家成就感
4. **平衡遊戲難度**：後期關卡難度提升時，傳奇強化提供持續成長
5. **戰術轉折點**：特殊傳奇強化（如TacticalExpansion）提供關鍵戰術選擇

### Buff詳細設計

遊戲共有**10種Buff**，分為**6種普通強化**和**4種傳奇強化**。

---

## 傳奇強化（4種）⭐

#### 1. Defense（裝甲強化）🛡️

**效果**：增加方塊HP
- **起始等級**：0
- **最大等級**：無上限
- **加成**：+1 HP / 等級
- **累積效果**：線性疊加

**實際效果**
| 等級 | 方塊HP |
|------|--------|
| 0 | 1 |
| 1 | 2 |
| 2 | 3 |
| 3 | 4 |
| 4 | 5 |
| 5 | 6 |

**策略定位**：
- 生存流核心
- 降低方塊被摧毀風險
- 適合後期高火力關卡
- 可無限疊加

---

#### 2. Volley（協同火力）🚀

**效果**：增加每個位置發射的導彈數量
- **起始等級**：0
- **最大等級**：無上限
- **加成**：+1 導彈/位置 / 等級
- **累積效果**：線性疊加

**實際效果**
| 等級 | 每個位置導彈數 |
|------|--------------|
| 0 | 1 |
| 1 | 2 |
| 2 | 3 |
| 3 | 4 |

**策略定位**：
- 火力流核心
- 快速清除敵人
- 視覺效果震撼
- 可無限疊加

---

#### 3. TacticalExpansion（戰術擴展）⚔️

**效果**：解鎖技能
- **起始等級**：0
- **最大等級**：2
- **Lv1效果**：解鎖處決技能
- **Lv2效果**：解鎖修補技能
- **累積效果**：逐步解鎖技能

**解鎖機制**：
- 初始狀態：兩個技能都未解鎖，UI顯示"Locked"，CP消耗顯示為空
- Lv1：解鎖處決技能，UI顯示"1"，CP消耗顯示"CP-5"
- Lv2：解鎖修補技能，UI顯示"2"，CP消耗顯示"CP-31"

**策略定位**：
- 戰術流核心
- 提供主動技能選擇
- 緊急情況的應對手段
- 屬於傳奇強化但有等級上限

---

## 普通強化（6種）

#### 1. Explosion（過載爆破）💣

**效果**：增加充能上限，溢出時對敵人造成傷害
- **充能上限增加**：+200 / 等級
- **起始等級**：1（初始上限200）
- **最大等級**：4（最多1000充能上限）
- **觸發條件**：方塊放置超出頂部
- **充能獲得方式**：
  - 反擊一次：+5充能
  - 消排一次：+50充能

**實際效果**
| 等級 | 充能上限 | 溢出傷害（當前充能值） |
|------|---------|---------------------|
| 1 | 200 | 0-200 |
| 2 | 400 | 0-400 |
| 3 | 600 | 0-600 |
| 4 | 1000 | 0-1000 |

**策略定位**：
- 將懲罰轉化為優勢
- 高風險高回報
- 適合激進快攻流
- 需要累積充能才能發揮效果

**權重**：8%（稀有）

---

#### 2. Salvo（齊射強化）🔥

**效果**：多行消除時增加導彈傷害
- **起始等級**：1
- **最大等級**：6
- **影響公式**：齊射加成 = (行數 - 1) × Salvo等級 × 0.5

**實際效果**（額外傷害）
| 等級 | 1行 | 2行 | 3行 | 4行 |
|------|-----|-----|-----|-----|
| 1 | 0 | 0.5 | 1.0 | 1.5 |
| 2 | 0 | 1.0 | 2.0 | 3.0 |
| 3 | 0 | 1.5 | 3.0 | 4.5 |
| 6 | 0 | 2.5 | 5.0 | 7.5 |

**策略定位**：
- 鼓勵多行消除
- 配合Volley爆發傷害
- 技巧型玩家首選

**權重**：12%（較常見）

---

#### 3. Burst（連發強化）⚡

**效果**：Combo傷害加成
- **起始等級**：1
- **最大等級**：6
- **影響公式**：連發加成 = Combo數 × 等級 × 0.25

**實際效果**（額外傷害）
| 等級 | Combo 5 | Combo 10 | Combo 20 |
|------|---------|----------|----------|
| 1 | 1.25 | 2.5 | 5.0 |
| 2 | 2.5 | 5.0 | 10.0 |
| 3 | 3.75 | 7.5 | 15.0 |
| 6 | 7.5 | 15.0 | 30.0 |

**策略定位**：
- 連擊流核心
- 需要持續消除
- 考驗操作穩定性

**權重**：12%（較常見）

---

#### 4. Counter（反擊強化）⚔️

**效果**：新放置方塊被擊中時反擊
- **起始等級**：1
- **最大等級**：6
- **反擊數量**：等級（發射導彈數）
- **觸發時間**：方塊放置後0.2秒內
- **額外效果**：反擊時增加5點爆炸充能

**實際效果**
| 等級 | 反擊導彈數 |
|------|-----------|
| 1 | 1 |
| 2 | 2 |
| 3 | 3 |
| 4 | 4 |
| 5 | 5 |
| 6 | 6 |

**策略定位**：
- 主動防守
- 高風險高回報
- 需要精準時機
- 可配合Explosion Buff累積充能

**權重**：10%（稀有）

---

#### 5. SpaceExpansion（空間擴充）📦

**效果**：解鎖儲存槽位
- **起始等級**：1（初始已解鎖1個槽位）
- **最大等級**：4（最多4個槽位）
- **加成**：+1 槽位 / 等級
- **累積效果**：線性疊加

**權重**：10%（稀有）

---

#### 6. ResourceExpansion（資源擴充）⚡

**效果**：增加CP上限
- **起始等級**：0
- **最大等級**：3
- **加成**：+50 CP上限 / 等級
- **累積效果**：線性疊加（初始100，最高250）

**權重**：8%（稀有）

---

### 技能系統（消耗CP）

**重要**：技能需要通過「戰術擴展」Buff解鎖後才能使用。
- 初始狀態：所有技能都未解鎖，無法使用
- 解鎖後：技能按鍵標籤顯示對應按鍵（"1"或"2"），CP消耗顯示對應消耗值

#### Execution（戰術處決）✂️

**效果**：清除每列最上面的方塊（削平表面）並發射導彈
- **使用方式**：按鍵1主動觸發
- **消耗**：5 CP
- **解鎖條件**：戰術擴展 Lv1
- **UI顯示**：
  - 未解鎖：按鍵標籤顯示"Locked"，CP消耗顯示為空
  - 已解鎖：按鍵標籤顯示"1"，CP消耗顯示"CP-5"

**實際效果**
```
處決前：
X X X X X X X X X X  ← 第20行
X X O O X X O X X X  ← 第19行
...

處決後：
O O X X O O X O O O  ← 新的底部（原第19行）
...
```

**策略定位**：
- 清理封閉空洞
- 緊急降低方塊高度
- 萬用救場工具

**權重**：8%（稀有）

---

#### Repair（結構修復）🔧

**效果**：填補封閉空洞並檢查消除
- **使用方式**：按鍵2主動觸發
- **消耗**：30 CP（實際顯示為"CP-31"，包含1點額外顯示）
- **解鎖條件**：戰術擴展 Lv2
- **演算法**：BFS廣度優先搜尋
- **UI顯示**：
  - 未解鎖：按鍵標籤顯示"Locked"，CP消耗顯示為空
  - 已解鎖：按鍵標籤顯示"2"，CP消耗顯示"CP-31"

**空洞定義**
```
封閉空洞：被方塊完全包圍的空格

範例：
X X X X X X X X X X
X X X O X X X X X X  ← O是封閉空洞
X X X X X X X X X X
```

**策略定位**：
- 修正失誤
- 優化方塊結構
- 技術型玩家工具

**權重**：10%（稀有）

---

### Buff權重系統

#### 普通強化權重（初始升級選項）

總權重：100%

| Buff | 權重 | 出現機率 |
|------|------|---------|
| Salvo | 20% | 高 |
| Burst | 20% | 高 |
| Counter | 15% | 中 |
| SpaceExpansion | 15% | 中 |
| ResourceExpansion | 15% | 中 |
| Explosion | 15% | 中 |

#### 傳奇強化選擇（普通強化滿級後）

傳奇強化不使用權重系統，當普通強化達到滿級時，從4種傳奇強化中隨機選擇（若數量≤3則全部顯示）：

- **Defense**（裝甲強化）：無上限，生存流核心
- **Volley**（協同火力）：無上限，火力流核心
- **TacticalExpansion**（戰術擴展）：最高2級，解鎖技能

**注意**：Execution 和 Repair 已改為消耗CP的主動技能，需要通過「戰術擴展」傳奇強化解鎖後才能使用。

### 升級策略建議

#### 流派1：坦克流
- **核心普通強化**：Counter, ResourceExpansion
- **核心傳奇強化**：Defense（無限疊加生存）
- **搭配**：Salvo
- **玩法**：堆高方塊，承受火力，緩慢推進
- **適合**：新手玩家

#### 流派2：火力流
- **核心普通強化**：Salvo（齊射強化，多行傷害加成）, Burst
- **核心傳奇強化**：Volley（協同火力，無限疊加導彈數）
- **搭配**：Counter
- **玩法**：快速消除，持續火力壓制
- **適合**：激進玩家

#### 流派3：連擊流
- **核心普通強化**：Burst（連發強化）, Salvo
- **核心傳奇強化**：Volley
- **搭配**：Counter
- **玩法**：維持高Combo，爆發傷害
- **適合**：技術玩家

#### 流派4：技能流
- **核心普通強化**：ResourceExpansion（增加CP上限）, SpaceExpansion
- **核心傳奇強化**：TacticalExpansion（解鎖技能）
- **搭配**：Defense
- **玩法**：利用主動技能（處決、修補）穩定推進
- **適合**：策略玩家

#### 流派5：爆炸流
- **核心普通強化**：Explosion（過載爆破）, Counter
- **核心傳奇強化**：Defense（保護方塊不被摧毀）
- **搭配**：ResourceExpansion
- **玩法**：累積充能，利用溢出懲罰造成巨額傷害
- **適合**：風險偏好型玩家

---

## 🎯 技能系統

### 主動技能

#### 技能1：Execution（戰術處決）

**使用條件**：消耗5 CP

**操作**：按鍵1

**效果**：清除每列底部的1個方塊（共10個方塊）

**CP消耗**：5 CP

**使用場景**：
- 底部堆積垃圾方塊
- 空洞難以填補
- 方塊高度過高需緊急降低

**技巧**：
- 配合消除使用可快速清理
- 不要浪費在單個空洞上
- 留作緊急情況

---

#### 技能2：Repair（結構修復）

**使用條件**：消耗30 CP

**操作**：按鍵2

**效果**：填補所有封閉空洞

**CP消耗**：30 CP

**演算法說明**：
```
1. 從頂部開始向下掃描
2. 對每個空格進行BFS
3. 如果無法到達頂部 = 封閉空洞
4. 填補該空洞
```

**使用場景**：
- S/Z方塊造成的不規則空洞
- 操作失誤留下的空洞
- 優化方塊結構

**技巧**：
- 在空洞較多時一次性清理
- 配合處決技能使用效果更佳
- 不要頻繁使用，保持技能儲備

---

### 被動技能

#### 反擊（Counter）

**觸發條件**：
1. 已解鎖Counter Buff
2. 方塊放置後0.2秒內
3. 該方塊被敵人子彈擊中

**效果**：
- 發射Counter等級數量的導彈
- 傷害與普通導彈相同
- 維持Combo不中斷

**視覺區分**：
- 金色導彈
- 特殊音效

**策略應用**：
- 在敵人射擊時機故意放置方塊
- 配合高防禦流保證方塊存活
- 提供額外火力輸出

---

## 🎨 視覺設計

### 美術風格

**整體風格**：科幻像素藝術 / 現代簡約

**色彩方案**：
- **主色調**：深藍、青色（科技感）
- **輔助色**：紅、橙（敵人、危險元素）
- **強調色**：金色、白色（重要信息）

### 方塊視覺

#### 顏色編碼
| 方塊形狀 | 顏色 | 色碼 |
|---------|------|------|
| I | 青色 | #00FFFF |
| O | 黃色 | #FFFF00 |
| T | 紫色 | #FF00FF |
| S | 綠色 | #00FF00 |
| Z | 紅色 | #FF0000 |
| J | 藍色 | #0000FF |
| L | 橙色 | #FF8800 |

#### 方塊類型視覺

**Normal方塊**
- 保持原有顏色
- 輕微發光邊緣
- HP以數字或顏色深度表示

**Void方塊**
- 深灰色 (#404040)
- 暗影漩渦動畫
- 盾牌圖示（不可摧毀標記）
- 受擊時顯示"無效"文字

**Explosive方塊**
- 暗紅色 (#8B0000)
- 脈動紅光效果
- 火花粒子持續噴出
- 危險標記（⚠️）
- 爆炸時大範圍衝擊波

### 彈藥視覺

#### 導彈（玩家）
- **基礎導彈**：
  - 青藍色 (#00AAFF)
  - 發光拖尾
  - 向上飛行軌跡
  
- **反擊導彈**：
  - 金色 (#FFD700)
  - 更亮的拖尾
  - 特殊閃光效果

#### 子彈（敵人）
- **Normal**：紅色圓球（RGB: 240, 69, 69）
- **AreaDamage**：橙色爆裂彈（RGB: 250, 115, 33）
- **AddBlock**：綠色方塊狀（RGB: 74, 222, 128）
- **AddExplosiveBlock**：黃色方塊狀（RGB: 255, 235, 4）
- **InsertRow**：紫色光束（RGB: 168, 84, 247）
- **InsertVoidRow**：深灰色巨大光束（RGB: 51, 51, 51）
- **CorruptExplosive**：洋紅色能量球（RGB: 255, 0, 255）
- **CorruptVoid**：青色能量球（RGB: 0, 255, 255）

### 特效設計

#### 消除特效
- **1行**：簡單閃光
- **2行**：藍色光波
- **3行**：紫色爆炸
- **4行**：金色衝擊波 + 螢幕震動

#### 擊中特效
- **導彈擊中敵人**：爆炸火花
- **子彈擊中方塊**：碎裂粒子
- **反擊觸發**：金色光環

#### 爆炸特效（Explosive方塊）
- 大範圍紅色衝擊波
- 火焰粒子四散
- 螢幕震動
- 警告音效

### UI視覺

#### 資訊面板
- **位置**：螢幕頂部
- **內容**：
  - 玩家HP（紅色條 + 數字）
  - 敵人HP（綠色條 + 數字）
  - 當前關卡（Stage X）
  - 分數（Score）
  - Combo（黃色高亮）

#### 齊射提示
- **位置**：網格中央
- **樣式**：
  - "齊射 x3!" - 青色
  - "超級齊射 x4!" - 金色
  - "虛無抵銷!" - 灰色
- **動畫**：放大淡出

#### 升級選單
- **背景**：半透明黑色遮罩
- **樣式**：科幻卡牌設計
- **內容**：
  - Buff圖示
  - Buff名稱
  - 當前等級
  - 效果描述
- **互動**：滑鼠懸停高亮

#### 彈出文字
- **傷害數字**：
  - 玩家造成：綠色
  - 玩家受到：紅色
  - 字體大小隨傷害變化
- **特殊文字**：
  - "反擊!" - 金色
  - "溢出懲罰" - 紅色
  - "封閉空洞" - 黃色

---

## 🔊 音效設計

### 音樂（BGM）

#### 正常戰鬥BGM
- **風格**：電子節奏、科幻氛圍
- **節奏**：120-140 BPM
- **情緒**：緊張但不過度壓迫
- **循環**：2-3分鐘無縫循環
- **參考**：Tetris主題 + 電子射擊遊戲

#### Boss戰BGM
- **風格**：史詩級電子樂
- **節奏**：140-160 BPM（更快）
- **情緒**：激昂、緊迫
- **特點**：更重的鼓點和bass
- **觸發**：Stage 5、10、15、20（Boss關卡）
- **層次**：隨Boss關卡遞增，音樂強度提升

### 音效（SFX）

#### 方塊操作
| 動作 | 音效描述 |
|------|---------|
| 移動 | 輕微嗶嗶聲 |
| 旋轉 | 咔噠機械聲 |
| 鎖定 | 沉重卡榫聲 |
| 硬降 | 快速下墜+重擊 |

#### 戰鬥音效
| 動作 | 音效描述 |
|------|---------|
| 發射導彈 | 咻~（科幻雷射） |
| 導彈擊中 | 爆炸音 |
| 敵人射擊 | 低沉脈衝聲 |
| 子彈擊中方塊 | 碎裂聲 |
| 反擊觸發 | 金屬鏗鏘聲 |
| 爆炸方塊爆炸 | 巨大爆炸音 + 低頻震動 |

#### 消除音效
| 行數 | 音效描述 |
|------|---------|
| 1行 | 簡單叮 |
| 2行 | 雙重叮叮 |
| 3行 | 和弦上升音 |
| 4行 | 完整和弦+特殊音效 |
| 虛無抵銷 | 低沉吸收音 + 回響 |

#### UI音效
| 動作 | 音效描述 |
|------|---------|
| 選單選擇 | 輕點聲 |
| 確認選擇 | 確認音 |
| 升級獲得 | 升級音效 |
| 關卡完成 | 勝利音樂 |
| 遊戲結束 | 失敗音效 |

#### 特殊音效
| 事件 | 音效描述 |
|------|---------|
| Combo增加 | 遞增音調 |
| Combo中斷 | 下降音效 |
| 技能使用 | 能量充能音 |
| 溢出懲罰 | 警報聲 |
| Boss登場 | 重低音震動 |

### 音效分層

#### 音量分類
- **BGM**：40-60%
- **SFX**：70-80%
- **UI音效**：50-60%

#### 優先級系統
1. **最高優先級**：重要提示（溢出、技能）
2. **高優先級**：戰鬥音效
3. **中優先級**：方塊操作
4. **低優先級**：環境音

---

## 🖥️ UI/UX設計

### 主遊戲畫面佈局

```
┌─────────────────────────────────────────┐
│  Stage 20  HP: 75/100  Score: 45820    │ ← 頂部資訊欄
│  Enemy HP: ████████░░ 80%              │
├─────────────────────────────────────────┤
│                                         │
│            [敵人圖像]                    │ ← 敵人顯示區
│                                         │
│  ┌─────────────────┐                   │
│  │                 │                   │
│  │   [遊戲網格]     │                   │ ← 方塊網格（10x20）
│  │    10 x 20      │                   │
│  │                 │                   │
│  └─────────────────┘                   │
│                                         │
│  Combo: 12  Next: [T]                  │ ← 底部資訊
│  技能: [處決 15s] [修復 Ready]          │
└─────────────────────────────────────────┘
```

### UI元素詳細設計

#### 1. 頂部資訊欄

**玩家資訊**
- **HP條**：
  - 紅色填充條
  - 數字顯示（當前/最大）
  - 受傷時閃爍紅色

- **分數**：
  - 實時更新
  - 大額分數增加時放大動畫

- **關卡顯示**：
  - "Stage X"文字
  - 關卡圖示

**敵人資訊**
- **HP條**：
  - 綠色填充條
  - 百分比顯示
  - 受傷時紅色傷害數字彈出
  - 低於25%時變紅+閃爍

#### 2. 網格區域

**網格視覺**
- 半透明格線
- 危險線（頂部3格）用紅色標記
- 背景微弱網格圖案

**方塊顯示**
- 清晰邊緣
- HP數字覆蓋在方塊上
- 不同類型方塊有明顯視覺區分

#### 3. 底部資訊

**Combo顯示**
- **位置**：網格左下
- **樣式**：
  - 低Combo（1-5）：白色
  - 中Combo（6-15）：黃色
  - 高Combo（16+）：金色+發光
- **倒數計時**：環形進度條

**下個方塊預覽**
- 小型方塊圖示
- 顯示形狀和顏色

**技能按鈕**
- 圖示 + 冷卻時間
- 可用時高亮+脈動
- 滑鼠懸停顯示描述

#### 4. 升級選單

**佈局**
```
┌─────────────────────────────────────────┐
│         選擇一個升級 (Level 3)          │
├─────────────────────────────────────────┤
│                                         │
│  ┌───────┐  ┌───────┐  ┌───────┐      │
│  │ 🛡️   │  │ 🚀   │  │ ⚔️   │      │
│  │Defense│  │Volley│  │Tactical│     │
│  │ Lv.2  │  │ Lv.1  │  │ NEW   │      │
│  │       │  │       │  │       │      │
│  │+1 HP  │  │+1導彈 │  │解鎖  │      │
│  │方塊   │  │每個位置│  │技能   │      │
│  └───────┘  └───────┘  └───────┘      │
│                                         │
└─────────────────────────────────────────┘
```

**卡牌設計**
- 圖示在頂部
- Buff名稱
- 當前等級（或NEW）
- 效果描述（簡短）
- 滑鼠懸停顯示詳細說明

**互動**
- 點擊選擇
- 選中時高亮
- 確認後淡出動畫

#### 5. 遊戲結束畫面

**勝利畫面**
```
┌─────────────────────────────────────────┐
│             🎉 勝利！ 🎉                │
│                                         │
│         你擊敗了深淵主宰！              │
│                                         │
│  最終分數：85,420                       │
│  最高Combo：68                          │
│  總消除行數：428                        │
│  總遊戲時間：2:18:35                    │
│                                         │
│  [重新開始]  [主選單]                   │
└─────────────────────────────────────────┘
```

**失敗畫面**
```
┌─────────────────────────────────────────┐
│             💀 失敗 💀                  │
│                                         │
│         在 Stage 15 被擊敗              │
│                                         │
│  最終分數：32,850                       │
│  最高Combo：42                          │
│                                         │
│  [重新開始]  [主選單]                   │
└─────────────────────────────────────────┘
```

### UX設計原則

#### 1. 資訊層級
- **關鍵資訊**：大字體，顯眼位置（HP, Combo）
- **次要資訊**：中等字體（分數, 關卡）
- **輔助資訊**：小字體（冷卻時間, 預覽）

#### 2. 反饋即時性
- 所有操作立即有視覺/聲音反饋
- 傷害數字彈出位置準確
- 狀態變化有過渡動畫

#### 3. 可讀性
- 高對比度文字
- 深色背景 + 亮色文字
- 重要資訊有背景遮罩

#### 4. 無干擾
- 遊戲進行時UI最小化
- 彈出文字快速消失
- 透明度適當避免遮擋

#### 5. 一致性
- 顏色編碼統一（紅=危險，綠=有利，黃=注意）
- 圖示風格一致
- 動畫時長統一（0.2-0.5秒）

---

## ⚖️ 遊戲平衡性

### 傷害公式平衡

#### 基礎設定
```
導彈基礎傷害：2
玩家基礎HP：100
方塊基礎HP：1
```

#### 平衡測試案例

**案例1：無升級狀態**
- 消除1行 = 1導彈 × 2傷害 = 2傷害
- 擊敗Stage 1（100 HP）需要50次消除
- 預期時間：~5分鐘

**案例2：中期（Stage 5）**
- 齊射Lv2 + 連發Lv1
- 消除3行，Combo 10
  - 導彈數：3 × (1 + 2) = 9發
  - 單發傷害：2 + (3-1)×2×0.5 + 10×1×0.25 = 6.5
  - 總傷害：9 × 6.5 = 58.5
- 擊敗Stage 5（500 HP）需要~9次3行消除

**案例3：後期（Stage 20）**
- 齊射Lv6 + 連發Lv6 + 協同Lv5
- 消除4行，Combo 30
  - 導彈數：4行 × 10位置 × (1 + 5協同) = 240發
  - 單發傷害：2 + (4-1)×6×0.5 + 30×6×0.25 = 56
  - 總傷害：240 × 56 = 13,440
- 擊敗Stage 20（5000 HP）需要~1次完美4行消除（高Combo狀態）

### 生存平衡

#### 敵人傷害分析
- **普通子彈**：1傷害/發
- **方塊防禦**：1 HP可抵擋1發

**無防禦升級**
- 每發子彈摧毀1方塊
- Stage 1射速：2s間隔 = 30發/分鐘
- 需要持續補充方塊

**防禦Lv3**
- 方塊HP = 4
- 每個方塊可抵擋4發
- 大幅降低方塊摧毀速度

### Buff價值分析

#### 傷害提升效率

| Buff | 等級1效果 | 價值評估 |
|------|----------|---------|
| Volley（協同火力） | +1導彈/位置 | ★★★★★ 最高 |
| Salvo（齊射強化） | +0.5傷害/額外行 | ★★★☆☆ 中等 |
| Burst | +0.25傷害/Combo | ★★★★☆ 高（需維持） |

**結論**：
- Volley（協同火力）最直接有效，增加導彈數量
- Burst需要技術但收益高
- Salvo（齊射強化）需要配合多行消除

#### 生存提升效率

| Buff | 等級1效果 | 價值評估 |
|------|----------|---------|
| Defense | +1 HP | ★★★★☆ 高 |
| Counter | 反擊1發 | ★★☆☆☆ 情境 |
| ResourceExpansion | +50 CP | ★★★☆☆ 策略 |

**結論**：
- Defense穩定提升生存
- ResourceExpansion提供更多技能使用機會
- Counter需要高技術

### 關卡難度曲線

#### 期望通關時間
| 關卡範圍 | 預期時間/關 | 階段累積 | 總累積時間 |
|---------|-----------|---------|-----------|
| 1-5（階段一） | 2-3分 | 10-15分 | 10-15分 |
| 6-10（階段二） | 3-4分 | 15-20分 | 25-35分 |
| 11-15（階段三） | 4-6分 | 20-30分 | 45-65分 |
| 16-20（階段四） | 6-10分 | 30-50分 | 75-115分 |

**完整通關預估**：1.5-2小時（熟練玩家）至3-4小時（新手玩家）

#### 升級獲得節奏
- 每關卡預期獲得1-2次升級
- 保證玩家成長與敵人強度匹配
- 後期關卡升級更頻繁（傷害累積快）

### 平衡調整建議

#### 如果太難
- 降低敵人HP 10-20%
- 提升升級獲得速度（降低需求傷害）
- 增加Buff效果數值

#### 如果太簡單
- 增加敵人射速
- 降低導彈基礎傷害
- 增加升級需求傷害

---

## 🔧 技術架構

### 系統架構圖

```
┌─────────────────────────────────────────┐
│           GameInitializer               │
│       (初始化所有系統)                   │
└─────────────────┬───────────────────────┘
                  │
      ┌───────────┼───────────┐
      │           │           │
      ▼           ▼           ▼
┌──────────┐ ┌──────────┐ ┌──────────┐
│  Game    │ │  Grid    │ │  Player  │
│ Manager  │ │ Manager  │ │ Manager  │
└────┬─────┘ └────┬─────┘ └────┬─────┘
     │            │            │
     └────────┬───┴───┬────────┘
              │       │
              ▼       ▼
        ┌──────────────────┐
        │   GameEvents     │
        │   (事件系統)      │
        └──────────────────┘
              │
      ┌───────┼───────┐
      ▼       ▼       ▼
┌──────────┐ ┌──────────┐ ┌──────────┐
│ Combat   │ │ Tetro-   │ │  Enemy   │
│ Manager  │ │  mino    │ │Controller│
└──────────┘ └──────────┘ └──────────┘
```

### 核心設計模式

#### 1. 單例模式 (Singleton)
**應用於**：所有管理器類

**優點**：
- 全域訪問點
- 確保唯一實例
- 避免重複初始化

**實作範例**：
```csharp
public class GameManager : MonoBehaviour
{
    public static GameManager Instance { get; private set; }
    
    void Awake()
    {
        if (Instance != null)
        {
            Destroy(gameObject);
            return;
        }
        Instance = this;
    }
}
```

#### 2. 事件驅動架構 (Event-Driven)
**應用於**：系統間通訊

**優點**：
- 解耦各系統
- 易於擴展
- 減少依賴

**實作範例**：
```csharp
public static class GameEvents
{
    public static event Action<int, bool> OnRowsCleared;
    public static event Action<float> OnEnemyDamaged;
    
    public static void TriggerRowsCleared(int count, bool hasVoid)
    {
        OnRowsCleared?.Invoke(count, hasVoid);
    }
}
```

#### 3. 對象池模式 (Object Pool)
**應用於**：導彈、子彈

**優點**：
- 減少實例化開銷
- 降低GC壓力
- 提升性能

**實作範例**：
```csharp
public class ObjectPool<T> where T : Component
{
    private Queue<T> pool = new Queue<T>();
    
    public T Get()
    {
        return pool.Count > 0 ? pool.Dequeue() : CreateNew();
    }
    
    public void Return(T obj)
    {
        obj.gameObject.SetActive(false);
        pool.Enqueue(obj);
    }
}
```

#### 4. 資料驅動設計 (Data-Driven)
**應用於**：關卡配置、Buff配置

**優點**：
- 非程式人員可編輯
- 易於平衡調整
- 支持熱更新

**實作範例**：
```csharp
[CreateAssetMenu]
public class StageDataSO : ScriptableObject
{
    public string stageName;
    public int stageIndex;
    public bool isBossStage;
    public int rewardBuffCount;
    public float maxHp;
    public float shootInterval;
    public float bulletSpeed;
    public int burstCount;
    
    // 8種子彈類型配置
    public BulletConfig normalBullet;
    public BulletConfig areaBullet;
    public BulletConfig addBlockBullet;
    public BulletConfig addExplosiveBlockBullet;
    public BulletConfig addRowBullet;
    public BulletConfig addVoidRowBullet;
    public BulletConfig corruptExplosiveBullet;
    public BulletConfig corruptVoidBullet;
    
    // 智能瞄準
    public bool useSmartTargeting;
}

[System.Serializable]
public class BulletConfig
{
    public bool enabled;
    public float chance; // 0-1的出現機率
}
```

### 性能優化策略

#### 1. 對象池
- **導彈池**：預分配50個
- **子彈池**：預分配100個
- **彈出文字池**：預分配20個

#### 2. 事件系統
- 避免在Update中輪詢
- 使用事件訂閱/發布
- 降低CPU佔用

#### 3. 批次更新
- 方塊視覺使用髒標記
- 只有變化時才更新
- 減少不必要的渲染調用

#### 4. 空間劃分
- 碰撞檢測使用網格座標
- O(1)時間複雜度
- 避免全局遍歷

### 技術規格

#### 開發環境
- **引擎**：Unity 6
- **語言**：C# 10
- **腳本後端**：IL2CPP / Mono
- **圖形API**：URP (Universal Render Pipeline)

#### 性能目標
- **幀率**：60 FPS（穩定）
- **記憶體**：< 200 MB
- **載入時間**：< 3秒
- **反應延遲**：< 16ms（輸入到顯示）

#### 平台支援
- **主要平台**：PC（Windows/Mac/Linux）
- **次要平台**：WebGL
- **未來擴展**：行動平台

---

## 🚀 未來擴展

### 短期擴展（1-3個月）

#### 1. 視覺增強
- [ ] 粒子特效系統
- [ ] 方塊破碎動畫
- [ ] 自訂Shader（發光、扭曲）
- [ ] 螢幕後處理（Bloom, Vignette）

#### 2. 音效完善
- [ ] 完整音效資源製作
- [ ] 動態音樂系統（根據戰況變化）
- [ ] 環境音效

#### 3. UI美化
- [ ] 自訂UI材質
- [ ] 動畫過渡
- [ ] 更豐富的視覺反饋

#### 4. 方塊儲存系統
原React版本已有的功能：
- [ ] A/S/D/F鍵儲存槽
- [ ] 預存方塊並交換
- [ ] 儲存槽UI顯示

### 中期擴展（3-6個月）

#### 1. 新遊戲模式

##### 無盡模式 (Endless Mode)
- 無限關卡
- 難度持續遞增
- 排行榜系統

##### 時間挑戰 (Time Attack)
- 限時擊敗Boss
- 速度獎勵
- 時間壓力下的策略

##### 每日挑戰 (Daily Challenge)
- 固定種子
- 全球排行
- 特殊規則

#### 2. 更多內容

##### 新Buff（10-15種）
- **穿透**：導彈貫穿敵人
- **分裂**：導彈擊中後分裂
- **護盾**：吸收子彈傷害
- **時間減速**：子彈速度減半
- **連鎖爆炸**：方塊摧毀時引爆周圍

##### 新敵人類型
- **快速型**：高速移動，低HP
- **坦克型**：高HP，慢射速
- **召喚型**：生成小怪
- **變形型**：切換攻擊模式

#### 3. 進度系統

##### 永久升級
- 跨局保留的升級點
- 解鎖新起始Buff
- 提升基礎屬性

##### 成就系統
- 50+成就
- 解鎖獎勵（皮膚、音樂）
- Steam成就整合

### 長期擴展（6-12個月）

#### 1. 多人模式

##### 合作模式 (Co-op)
- 2人共享網格
- 分工合作
- 特殊合作技能

##### 對戰模式 (PvP)
- 消除行發送垃圾給對手
- 1v1或2v2
- 排位系統

#### 2. 自訂內容

##### 關卡編輯器
- 自訂敵人屬性
- 自訂攻擊模式
- 分享關卡

##### Mod支援
- 自訂Buff
- 自訂方塊形狀
- 自訂視覺效果

#### 3. 故事模式

##### 劇情戰役
- 10+章節
- 過場動畫
- 角色對話
- 故事解鎖

#### 4. 跨平台

##### 行動平台
- 觸控操作優化
- UI適配
- 性能優化

##### 主機平台
- 手把支援
- 成就系統
- 雲端存檔

### 社群功能

#### 排行榜
- 全球排行
- 好友排行
- 每週重置

#### 回放系統
- 錄製遊戲過程
- 分享精彩時刻
- 學習高手操作

#### 社交分享
- 一鍵分享成績
- 截圖分享
- 影片導出

---

## 📝 開發檢查清單

### 核心功能 ✅
- [x] 俄羅斯方塊系統
- [x] 網格管理
- [x] 戰鬥系統
- [x] 敵人AI
- [x] Combo系統
- [x] Roguelike升級
- [x] 10種Buff（6普通+4傳奇）
- [x] 技能系統（需TacticalExpansion解鎖）
- [x] 方塊類型系統（Normal + Explosive + Void）

### Unity場景設置 ⚠️
- [ ] 場景物件建立
- [ ] 預製體製作（Block, Missile, Bullet）
- [ ] UI Canvas設置
- [ ] 攝影機配置

### 資源建立 ✅
- [x] 20個關卡ScriptableObject
- [x] 10個Buff ScriptableObject（6普通+4傳奇）
- [ ] 音效資源（8+ clips）
- [ ] 音樂資源（2 tracks）
- [x] 方塊精靈圖
- [x] 彈藥精靈圖（8種子彈類型）

### 測試 ⚠️
- [ ] 功能測試
- [ ] 平衡測試
- [ ] 性能測試
- [ ] 多平台測試

### 文檔 ✅
- [x] 遊戲設計文件（本文件）
- [x] 技術總結
- [x] 設置指南
- [x] 專案說明

---

## 📄 結語

Tenronis是一款融合俄羅斯方塊與彈幕射擊的創新遊戲，提供獨特的攻守一體體驗。通過Roguelike升級系統和多樣化的Buff選擇，每局遊戲都有不同的策略深度和重玩價值。

### 核心優勢
1. **創新玩法**：俄羅斯方塊 + 射擊的獨特結合
2. **策略深度**：10種Buff（6普通+4傳奇）+ 8種敵人子彈類型
3. **豐富內容**：20個關卡，4個Boss戰
4. **高重玩性**：Roguelike隨機升級系統
5. **技術優秀**：清晰的架構和優化
6. **易於擴展**：為未來內容預留空間

### 目標玩家反饋
- **益智玩家**："熟悉的俄羅斯方塊，全新的戰鬥體驗"
- **動作玩家**："緊張刺激的戰鬥節奏"
- **Roguelike愛好者**："豐富的成長系統和策略選擇"

### 開發里程碑
- ✅ **階段1**：核心機制實作（已完成）
- ⚠️ **階段2**：Unity場景設置（進行中）
- ⏳ **階段3**：內容填充和測試
- ⏳ **階段4**：優化和發布

---

**文件版本**：2.1  
**製作日期**：2025年11月26日  
**最後更新**：2025年12月1日  
**Unity版本**：Unity 6  
**文件狀態**：✅ 完整

**更新內容**（v2.1）：
- 修正Buff分類：TacticalExpansion為傳奇強化
- 明確10種Buff結構：6種普通強化 + 4種傳奇強化
- 更新權重系統：普通強化單獨計算權重
- 更新流派建議：區分普通強化和傳奇強化搭配

**更新內容**（v2.0）：
- 擴展至20個關卡（原10個）
- 新增8種子彈類型系統（原4種）
- 4個Boss關卡設計
- 完整的難度曲線和階段劃分

**專案狀態**：核心系統完成，20關卡內容已配置

---

**Tenronis - 在方塊與火力之間，掌控戰場！** 🎮✨


